<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8" />
  <title>Моят профил | Online Test Generator</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- Твоят собствен CSS -->
  <link
    rel="stylesheet"
    href="css/style.css"
  />
</head>
<body>

<header>
  <h2>Online Test Generator</h2>
</header>

<nav>
  <a id="loginLink" href="login.html">Login</a>
  <a id="registerLink" href="register.html">Register</a>
  <a id="adminLink" href="adminPanel.html" style="display: none;">Admin Panel</a>
  <a id="profileLink" href="profile.html" style="display: none;">Моят акаунт</a>
  <a id="logoutLink" href="/auth/logout" style="display: none;">Изход</a>
</nav>

<div class="container my-4">
  <h1>Моят профил</h1>
  <div id="profile-info" class="mt-3">
    <!-- Тук ще покажем информация за потребителя -->
  </div>
</div>

<footer>
  <p>&copy; 2025 OnlineTestGenerator</p>
</footer>

<!-- Bootstrap JS (ако ти трябва) -->
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
</script>

<script>
  // Когато страницата се зареди:
  window.onload = async function() {
    try {
      // 1) Проверяваме сесията/ролята
      const response = await fetch('/auth/status');
      const data = await response.json();

      if (!data.loggedIn) {
        // Ако не е логнат, го пращаме към login
        window.location.href = '/login.html';
        return;
      }

      // Ако е логнат, показваме/скриваме бутоните
      document.getElementById('loginLink').style.display = 'none';
      document.getElementById('registerLink').style.display = 'none';
      document.getElementById('logoutLink').style.display = 'inline-block';
      document.getElementById('profileLink').style.display = 'inline-block';

      if (data.user.role === 'admin') {
        document.getElementById('adminLink').style.display = 'inline-block';
      }

      // 2) Показваме данните на потребителя в #profile-info
      const user = data.user;
      const profileDiv = document.getElementById('profile-info');
      profileDiv.innerHTML = `
        <p><strong>Здравей, ${user.username}!</strong></p>
        <p>Твоята роля е: <strong>${user.role}</strong></p>
      `;

      // Ако искаш да покажеш още инфо (напр. имейл, дата на регистрация...), добави го тук
    } catch (err) {
      console.error('Error loading profile:', err);
    }
  };
</script>

</body>
</html>
